<!DOCTYPE html>
<html lang="en">
    <head>
        <title>{{ g.title | replace("Torrents.com", g.domain_capitalized, 1)}}</title>
        {% if not g.override_header %}
            <meta http-equiv="content-language" content="en" />
            {% if g.page_description %}
            <meta name="description" content="{{g.page_description}}" />
            {% endif %}
            <meta name="keywords" content="{{(g.keywords|list)[:17]|join(', ')}}" />
        {% endif %}
        <link rel="search" type="application/opensearchdescription+xml" href="{{ url_for('index.opensearch') }}" title="Torrents" />
        <meta charset="utf-8" />
        <link rel="shortcut icon" href="{{ url_for('index.favicon') }}" />
        {%- block assets -%}
            {%- assets "css_torrents" -%}
                <link type="text/css" href="{{ ASSET_URL }}" rel="stylesheet" />
            {%- endassets -%}
            {%- assets "js_torrents" -%}
                <script src="{{ ASSET_URL }}"></script>
            {%- endassets -%}
        {%- endblock -%}
        <script type="text/javascript">
            {%-if g.track%}$('<img src="{{url_for("files.pixel")}}"/>');{%-endif%}
            var _gaq, _prum;
            function cookiesScripts(){
                _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-38333996-1']); _gaq.push(['_setDomainName', '{{ g.domain }}']);
                _gaq.push(['_setAllowLinker', true]); _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();

                {% if g.blacklisted_content %}
                _gaq.push(['_trackEvent', "Blacklisted", "{{g.blacklisted_content}}"]);
                {% endif %}

                {% if g.RUM_code %}
                _prum = [['id', '{{g.RUM_code}}'],
                             ['mark', 'firstbyte', (new Date()).getTime()]];
                (function() {
                    var s = document.getElementsByTagName('script')[0]
                      , p = document.createElement('script');
                    p.async = 'async';
                    p.src = '//rum-static.pingdom.net/prum.min.js';
                    s.parentNode.insertBefore(p, s);
                })();
                {% endif %}
                {%- block cookies -%}
                {%- endblock -%}
            }
        {% if g.must_accept_cookies %}
        </script>
        <script type="application/javascript" src="{{url_for('news.cookies')}}"></script>
        {% else %}
            $(function(){cookiesScripts()});
        </script>
        {% endif %}
        {%- block head -%}
        {%- endblock -%}
    </head>
    {% set hidden_category = g.category and not g.category in g.categories[:5] -%}
    {% set hidden_categories_start = 5 if hidden_category else 6 -%}
    <body
        data-downloader_title="Hey!<br/>You need a Torrent client to download this file"
        data-downloader_text="Download Torrents Downloader to get this file right now.<br/>Our sofware lets you download torrents faster and more easily than ever - absolutely free! If you already have a Torrent client, click <i>No, thanks</i>."
        data-downloader_href="{{'http://torrents.com/downloader'|forceescape}}"
        data-downloader_yes="<p>Yes, download</p>Torrents Downloader"
        data-downloader_no="<p>No, thanks</p>I already have a torrent client"
        {{ body_class|safe if body_class }}
        >
        <div id="dialog" data-dialog_ok="{{'ok'}}" data-dialog_no="{{'no'}}" data-dialog_yes="{{'yes'}}"></div>
        <header>
            <div id="header">
                <div class="container_24">
                    <div class="grid_7">
                        <a class="logo" href="/"><img src="{{g.static_prefix}}/torrents.png" alt="Torrents" title="Torrents" /><img src="{{g.static_prefix}}/dot-{{g.domain.split('.')[-1]}}.png" alt=".com"/></a>
                    </div>
                    <div id="main-nav" class="grid_17">
                        <a href="{{ url_for('news.home') }}"{{' class=active' if g.section=="news" }}><div class="arrow"></div>News</a>
                        <a href="{{ url_for('web.home') }}"{{' class=active' if g.section=="downloader" }}><div class="arrow"></div>Downloader</a>
                        <a href="{{ url_for('files.home') }}"{{' class=active' if g.section=="torrents" }}><div class="arrow"></div>Torrents</a>
                    </div>
                </div>
                <div id="search-banner">
                    <div class="container_24">
                        <form method="get" action="{{ url_for('files.search', query='') }}" class="grid_24">
                            <input type="hidden" name="c" value="{{g.category.url if g.category else ""}}" />
                            <div class="grid_18 alpha"><input placeholder="find torrents" type="text" id="q" name="q" autocomplete="off" value="{{g.query or ""}}"/></div>
                            <div class="grid_6 omega"><button type="submit">Search files&nbsp;&nbsp;&nbsp;<span class="icon-search"></span></button></div>
                        </form>
                        <ul class="grid_24">
                            <li{{ ' class=active' if g.category==None and g.section=="torrents" }}><a href="{{ url_for('files.search', query=g.clean_query ) if g.category and g.clean_query else url_for('files.home')}}"><div class="arrow"></div>all torrents</a></li>
                            {% for category in g.categories %}
                            <li{{' class=active' if g.category == category and g.section=="torrents" }}><a href="{{ url_for('files.category', category=category.url, query=None if g.category == category else g.clean_query )}}"><div class="arrow"></div>{{category.title|lower}}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </header>
        <article>
            {%- with messages = get_flashed_messages(with_categories=true) %}
                {%- if messages %}
                    <div id="messages">
                        {%- for category, message in messages %}
                        <div class="{{ category }}"><div class="container_24"><p class="grid_24">{{ message }}</p></div></div>
                        {%- endfor %}
                    </div>
                {%- endif %}
            {%- endwith %}
            <div class="container_24 {{g.extra_container_classes if g.extra_container_classes}}">
                {%- block content %}{%- endblock %}
            </div>
            {%- block lower_content %}{%- endblock %}
        </article>
        <footer>
            <div id="footer">
              <div class="footer-top">
                <div class="logo">
                  <a href="/">
                    <img src="{{g.static_prefix}}/logo.torrents-220-khaki.png" alt="Torrents" title="Torrents"/>
                  </a>
                </div>
                <div class="general-links">
                   <ul>
                       <li><a href="{{ url_for('index.about') }}">About</a></li><li><a href="{{ url_for('index.contact') }}">Contact</a></li><li><a href="{{ url_for('index.legal') }}">Terms &amp; Privacy</a></li><li><a href="{{ url_for('files.copyright') }}">Copyright</a></li>
                   </ul>
                </div>
                <div class="networks">
                  <ul>
                    <li>
                      <a href="{{ url_for('news.rss') }}">
                        <img src="{{g.static_prefix}}/ico.rss-30-self.png" alt="Follow us via RSS"/>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="footer-bottom">
                <div class="family">
                  <p>the Torrents.com family of sites:</p>
                </div>
                <ul class="tree">
                  <li class="domain"><a href="{{ url_for('news.home') }}">Torrents<span>.com</span></a>
                    <ul>
                      <li><a href="{{ url_for('news.home', path='category/movies') }}">Movies</a></li>
                      <li><a href="{{ url_for('news.home', path='category/music') }}">Music</a></li>
                      <li><a href="{{ url_for('news.home', path='category/tv') }}">TV</a></li>
                    </ul>
                  </li>
                  <li class="domain"><a href="{{ url_for('web.home') }}">Torrents<span>.ms</span></a>
                    <ul>
                      <li><a href="{{ url_for('web.home') }}">Torrents downloader</a></li>
                    </ul>
                  </li>
                  <li class="domain"><a href="{{ url_for('files.home') }}">Torrents<span>.fm</span></a>
                    <ul>
                      <li><a href="{{ url_for('files.popular') }}">Popular torrents</a></li>
                      <li><a href="{{ url_for('files.recent') }}">Recent torrents</a></li>
                      <li><a href="{{ url_for('files.popular_searches') }}">Popular searches</a></li>
                      <li><a href="{{ url_for('files.recent_searches') }}">Recent searches</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
        </footer>
    </body>
</html>
